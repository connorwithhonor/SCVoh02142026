# n8n Self-Hosted Setup Guide

Complete guide to set up your self-hosted n8n instance for automated blog posting.

## Prerequisites

- n8n running on your local machine or server
- Anthropic API key
- GitHub Personal Access Token

---

## Step 1: Access Your n8n Instance

Open your browser and go to your n8n instance:
- **Local:** http://localhost:5678
- **Server:** http://your-server-ip:5678

---

## Step 2: Add Anthropic API Credentials

1. Click **"Settings"** (gear icon) in left sidebar
2. Click **"Credentials"**
3. Click **"New Credential"**
4. Search for **"HTTP Header Auth"** (we'll use this for Anthropic)
5. Configure:
   - **Name:** `Anthropic API`
   - **Name:** `x-api-key`
   - **Value:** `your-anthropic-api-key-here`
6. Click **"Save"**

**Get your Anthropic API key:**
- Go to: https://console.anthropic.com/
- Click **"API Keys"**
- Click **"Create Key"**
- Copy the key (starts with `sk-ant-...`)
- Add $5-10 to your account (Settings ‚Üí Billing)

---

## Step 3: Add GitHub Credentials

1. In n8n, click **"Settings"** ‚Üí **"Credentials"**
2. Click **"New Credential"**
3. Search for **"GitHub"**
4. Select **"GitHub API"**
5. Configure:
   - **Credential Type:** Access Token
   - **Access Token:** `your-github-token-here`
   - **Name:** `GitHub API`
6. Click **"Save"**

**Get your GitHub token:**
- Go to: https://github.com/settings/tokens
- Click **"Generate new token (classic)"**
- Name: `n8n Blog Automation`
- Scopes: Check **`repo`** (all repo permissions)
- Click **"Generate token"**
- Copy immediately (you won't see it again!)

---

## Step 4: Import the Workflow

1. In n8n, click **"Workflows"** in left sidebar
2. Click **"Add Workflow"** (+ button)
3. Click the **three dots** (‚ãÆ) in top right
4. Select **"Import from File"** or **"Import from URL"**

**Import the JSON:**

Open `N8N_AUTOMATION_SETUP.md` in this directory, copy the entire workflow JSON (starting from line 54), and paste it into the import dialog.

Or manually copy-paste this workflow JSON:

```json
{
  "name": "Santa Clarita Daily Blog Generator",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 6,12,18 * * *"
            }
          ]
        }
      },
      "name": "3x Daily (6am, 12pm, 6pm PT)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [250, 300],
      "typeVersion": 1,
      "notes": "Runs 3 times per day for maximum content velocity"
    },
    {
      "parameters": {
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "anthropicApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "claude-haiku-3-5-20241022"
            },
            {
              "name": "max_tokens",
              "value": 2000
            }
          ]
        },
        "options": {}
      },
      "name": "Claude Haiku (Generate Content)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [650, 300],
      "typeVersion": 3
    }
  ],
  "connections": {
    "3x Daily (6am, 12pm, 6pm PT)": {
      "main": [
        [
          {
            "node": "Select City & Topic",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "timezone": "America/Los_Angeles"
  }
}
```

**Note:** The full workflow JSON is in `N8N_AUTOMATION_SETUP.md` - use that complete version!

---

## Step 5: Configure Credentials in Workflow

After importing:

1. Click on the **"Claude Haiku (Generate Content)"** node
2. Under **"Credentials"**, select **"Anthropic API"** (the one you created)
3. Click on the **"GitHub (Create Blog Post)"** node
4. Under **"Credentials"**, select **"GitHub API"** (the one you created)
5. Click **"Save"** (floppy disk icon in top right)

---

## Step 6: Test the Workflow

**Manual Test Run:**

1. Click **"Execute Workflow"** button (‚ñ∂ icon) in top right
2. Watch the execution panel on the right
3. You should see:
   - ‚úÖ City & topic selected
   - ‚úÖ Content generated by Claude
   - ‚úÖ Markdown formatted
   - ‚úÖ File created in GitHub

4. Check your GitHub repo:
   - Go to: https://github.com/connorwithhonor/SCVoh02142026/tree/main/src/content/blog
   - You should see a new `.md` file with today's date

5. Check Netlify:
   - Build should trigger automatically
   - Visit your Netlify site to see the new post

**If the test works, you're ready to activate!**

---

## Step 7: Activate the Workflow

1. Toggle the **"Active"** switch in top right (turns green)
2. The workflow will now run automatically 3 times per day:
   - **6:00 AM PT** (morning post)
   - **12:00 PM PT** (noon post)
   - **6:00 PM PT** (evening post)

**That's it! You're done!**

---

## Monitoring & Maintenance

### Check Workflow Executions

1. In n8n, click **"Executions"** in left sidebar
2. See all past runs (successful and failed)
3. Click any execution to see details

### View Logs

Look for:
- ‚úÖ Green checkmarks = success
- ‚ùå Red X = failed (click to see error)

### Common Issues

**"Anthropic API error 401"**
- Your API key is wrong or expired
- Check credentials in Settings ‚Üí Credentials

**"GitHub API error 404"**
- Repository name is wrong
- Check that it's: `connorwithhonor/SCVoh02142026`

**"No posts being created"**
- Check if workflow is Active (toggle should be green)
- Check Executions tab for errors
- Verify timezone is set to "America/Los_Angeles"

---

## Customization

### Change Posting Frequency

**Current:** 3 posts/day (6am, 12pm, 6pm)

**To change to 2 posts/day (6am, 6pm):**
1. Click "3x Daily" schedule node
2. Change cron expression from `0 6,12,18 * * *` to `0 6,18 * * *`

**To change to 5 posts/day:**
- Use: `0 6,9,12,15,18 * * *`

### Change Content Prompts

1. Click "Claude Haiku (Generate Content)" node
2. Edit the `prompt` parameter
3. Add more context, change tone, adjust length, etc.

### Add More Cities

1. Click "Select City & Topic" node
2. Add cities to the `cities` array in the function code

---

## Cost Monitoring

### Check Anthropic Usage

1. Go to: https://console.anthropic.com/
2. Click **"Usage"**
3. See daily costs (should be $0.10-0.30/day for 3 posts)

### Monthly Cost Estimate

- **90 posts/month:** ~$6-9
- **180 posts/month (6/day):** ~$12-18
- Still incredibly cheap!

---

## Backup Your Workflow

**Export the workflow** (in case you need to restore):

1. Click three dots (‚ãÆ) in top right
2. Click **"Download"**
3. Save JSON file somewhere safe

---

## When to Update

**Update the workflow if:**
- You want to target different cities
- Content quality needs adjustment
- You want to change posting times
- API responses change

Just edit the nodes and click Save!

---

## Success Checklist

- ‚úÖ Anthropic API credentials added
- ‚úÖ GitHub API credentials added
- ‚úÖ Workflow imported
- ‚úÖ Credentials configured in workflow
- ‚úÖ Test execution successful
- ‚úÖ New post visible in GitHub
- ‚úÖ Netlify build triggered
- ‚úÖ Post visible on site
- ‚úÖ Workflow activated (green toggle)
- ‚úÖ First scheduled post published

**You're live! 90 posts/month incoming.** üöÄ

---

## Next Steps After Activation

1. **Day 1:** Verify first 3 posts published (6am, 12pm, 6pm)
2. **Week 1:** Review 21 posts for quality
3. **Week 2:** Check Google Search Console for indexing
4. **Month 1:** 90 posts published - massive SEO signal
5. **Month 2:** Start seeing organic traffic
6. **Month 3-6:** Rankings climb steadily
7. **Month 12:** #1 quoted source for Santa Clarita sellers

**Welcome to automated content domination!** üèÜ
